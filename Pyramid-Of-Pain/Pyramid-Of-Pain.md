# Pyramid-Of-Pain
The **Pyramid of Pain** is a concept developed by **David J. Bianco** to illustrate the difficulty of detecting and disrupting an attacker‚Äôs operations based on the types of Indicators of Compromise (IoCs) used. The pyramid consists of six levels, where higher levels indicate greater difficulty for the attacker to evade detection.



üî∫ **The Six Levels of the Pyramid of Pain:**

**1Ô∏è‚É£ Hash Values**

* Examples: **SHA1, MD5, SHA256** of a malicious file
* ‚ö†Ô∏è Easy for attackers to evade by modifying the file slightly, which generates a new hash.

**2Ô∏è‚É£ IP Addresses**

* Examples: 192.168.1.1, IP of a **command-and-control (C2)** server
* ‚ö†Ô∏è Attackers can easily change IPs using VPNs, proxies, or botnets.

**3Ô∏è‚É£ Domain Names**

* Examples: malicious[.]com, phishing[.]xyz
* ‚ö†Ô∏è Harder to change than an IP, but attackers use Domain Generation Algorithms (DGA) or disposable domain services.

**4Ô∏è‚É£ Network/Host Artifacts**

* Examples: File paths, abnormal network configurations, unique User-Agents
* ‚ö†Ô∏è Changing these artifacts requires more effort from the attacker, affecting their operations.

**5Ô∏è‚É£ Tools**

* Examples: **Mimikatz, Cobalt Strike, Metasploit**
* ‚ö†Ô∏è Attackers can switch tools, but it disrupts their workflow and requires reconfiguration.

**6Ô∏è‚É£ Tactics, Techniques & Procedures (TTPs)**

* Examples: Lateral movement via **RDP, Credential Dumping, DNS Tunneling**
* ‚ö†Ô∏è The hardest to change because it affects the attacker's fundamental strategy, requiring time, training, and new resources.

## Hash Value
A **hash value** is a fixed-length string generated by a cryptographic hash function that uniquely represents a piece of data, such as a file, password, or message

* **Question :** Analyse the report associated with the hash "b8ef959a9176aef07fdca8705254a163b50b49a17217a4ff0107487f59d4a35d". What is the filename of the sample?

![Image](https://github.com/user-attachments/assets/92828f0b-7a0e-41d9-a7ab-0636b34255d0)

    Answer : Sales_Receipt 5606.xls

## IP Address

An **IP address** (Internet Protocol address) is a unique numerical label assigned to a device connected to a network. It serves two main purposes: **identification** of a device and **location addressing** for communication over the internet or local networks.

* **Question 1 :** By reading the following [report](https://assets.tryhackme.com/additional/pyramidofpain/task3-anyrun.pdf),  What is the **first IP address** the malicious process (**PID 1632**) attempts to communicate with?

![Image](https://github.com/user-attachments/assets/5072ebe5-64ba-4074-a0b0-d9cf32dc32be)

    Answer : 50.87.136.52

* **Question 2 :** By reading the following [report](https://assets.tryhackme.com/additional/pyramidofpain/task3-anyrun.pdf), What is the **first domain name** the malicious process (**PID 1632**) attempts to communicate with?

![Image](https://github.com/user-attachments/assets/dfe35a0d-06a0-4f2d-a6c9-3fbfb50ac133)

    Answer : craftingalegacy.com

## Domain Names

A **domain name** is a human-readable address used to access websites and other online resources. It acts as an easy-to-remember label for an **IP address**, allowing users to navigate the internet without needing to memorize numerical IP addresses.

- **Question 1 :** Go to [this report on app.any.run](https://app.any.run/tasks/a66178de-7596-4a05-945d-704dbf6b3b90) and provide the first suspicious domain request you are seeing, you will be using this report to answer the remaining questions of this task.

![Image](https://github.com/user-attachments/assets/26469c3c-09a4-4107-9349-c5577c886398)

        Answer : craftingalegacy.com

- **Question 2 :** What term refers to an address used to access websites?

        Answer : Domaine Name
    
- **Question 3 :** What type of attack uses Unicode characters in the domain name to imitate the a known domain?

        Answer : Punycode attack

 - **Question 4 :** Provide the redirected website for the shortened URL using a preview: https://tinyurl.com/bw7t8p4u

![Image](https://github.com/user-attachments/assets/005919f6-c5ee-4440-bd16-8cb53cb99834)

        Answer : https://tryhackme.com/

## Host Artifacts
**Host artifacts** refer to traces of activity left on a system that can be used to detect malicious behavior, investigate security incidents, and identify attackers‚Äô techniques. These artifacts are crucial for **digital forensics and incident response** (**DFIR**).

**A security vendor has analysed the malicious sample for us. Review the report [here](https://assets.tryhackme.com/additional/pyramidofpain/task5-report.pdf) to answer the following questions-** 

- **Question 1 :** A process named **regidle.exe** makes a POST request to an IP address based in the United States (US) on **port 8080**. What is the IP address?

![Image](https://github.com/user-attachments/assets/b782d759-e622-4e5c-b068-bbc869b68885)

       Answer : 96.126.101.6
- **Question 2 :** The actor drops a malicious executable (EXE). What is the name of this executable?

![Image](https://github.com/user-attachments/assets/254c1a77-a052-4544-83ff-f675f659d7f5)

       Answer : G_jugk.exe

- **Question 3 :** Look at this [report](https://assets.tryhackme.com/additional/pyramidofpain/vtotal2.png) by Virustotal. How many vendors determine this host to be malicious?

![Image](https://github.com/user-attachments/assets/42077522-4f8b-411a-acb8-8692509fddc7)

       Answer : 9

## Network Artifacts 

**Network artifacts** are traces of network activity that help security professionals detect cyber threats, investigate incidents, and analyze attacker behavior. These artifacts provide insights into **communication patterns, suspicious traffic, and unauthorized access.**

- **Question 1 :** What browser uses the User-Agent string shown in the screenshot below?

![Image](https://github.com/user-attachments/assets/b2714da5-91a1-4d0b-b024-be0d7b00c6df)

      Answer : Internet Explorer

## Tools

* **Question 1 :** Provide the method used to determine similarity between the files 

         Answer : Fuzzy Hashing

* **Question 2 :** Provide the alternative name for fuzzy hashes without the abbreviation

![Image](https://github.com/user-attachments/assets/1bbda0a1-ba44-4dfb-9a4a-a74a98fefb12)

          Answer : context triggered piecewise hashes

## TTPs (Tactics, Techniques & Procedures)
**Tactics, Techniques, and Procedures (TTPs)** are key concepts in cybersecurity used to describe the methods and behaviors of attackers. They provide a structured way to understand and analyze adversary activities in a systematic manner.

- **Question 1 :** Navigate to ATT&CK Matrix webpage. How many techniques fall under the Exfiltration category?

![Image](https://github.com/user-attachments/assets/31c722a8-7669-4d28-a838-8f2cc281d978)

         Answer : 9

- **Question 2 :** Chimera is a China-based hacking group that has been active since 2018. What is the name of the commercial, remote access tool they use for C2 beacons and data exfiltration?

![Image](https://github.com/user-attachments/assets/1de65d62-500b-41fc-95c4-5416b55eda7d)

         Answer : Cobalt Strike
